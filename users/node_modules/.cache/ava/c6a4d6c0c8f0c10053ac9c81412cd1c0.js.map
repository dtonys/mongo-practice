{"version":3,"sources":["read_test.js"],"names":["before","t","start","beforeEach","db","context","User","models","console","log","collections","users","drop","NEW_USER_NAME","joe","name","save","find","is","_id","toString","findOne","user"],"mappings":";;AAAA;;;;AACA;;AAEA;;;;;;AAIA,cAAKA,MAAL,CAAY,cAAZ;AAAA,uDAA4B,iBAAMC,CAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACpB,wBAAcC,KAAd,EADoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA5B;;AAAA;AAAA;AAAA;AAAA;;AAIA,cAAKC,UAAL,CAAgB,4BAAhB;AAAA,wDAA8C,kBAAOF,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAC3B,kCAD2B;;AAAA;AACtCG,cADsC;;AAE5CH,cAAEI,OAAF,CAAUD,EAAV,GAAeA,EAAf;;AAF4C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA9C;;AAAA;AAAA;AAAA;AAAA;;AAKA,mBAAK,qCAAL;AAAA,wDAA4C,kBAAOH,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAClCG,cADkC,GAC3BH,EAAEI,OADyB,CAClCD,EADkC;AAEpCE,gBAFoC,GAE7BF,GAAGG,MAAH,CAAU,MAAV,CAF6B;;;AAI1CC,oBAAQC,GAAR,CAAY,gBAAZ;AACAD,oBAAQC,GAAR,CAAYL,GAAGM,WAAf;;AAEAF,oBAAQC,GAAR,CAAY,IAAZ;AACAD,oBAAQC,GAAR,CAAYL,EAAZ;;AAR0C;AAAA,mBAUpCA,GAAGM,WAAH,CAAeC,KAAf,CAAqBC,IAArB,EAVoC;;AAAA;AAYpCC,yBAZoC,GAYpB,KAZoB;AAapCC,eAboC,GAa9B,IAAIR,IAAJ,CAAS,EAAES,MAAMF,aAAR,EAAT,CAb8B;AAAA;AAAA,mBAcpCC,IAAIE,IAAJ,EAdoC;;AAAA;AAAA;AAAA,mBAetBV,KAAKW,IAAL,CAAU,EAAEF,MAAMF,aAAR,EAAV,CAfsB;;AAAA;AAepCF,iBAfoC;;;AAiB1CV,cAAEiB,EAAF,CACEP,MAAM,CAAN,EAASQ,GAAT,CAAaC,QAAb,EADF,EAEEN,IAAIK,GAAJ,CAAQC,QAAR,EAFF,EAGE,yDAHF;;AAjB0C;AAAA,mBAuBvBd,KAAKe,OAAL,CAAa,EAAEF,KAAKL,IAAIK,GAAX,EAAb,CAvBuB;;AAAA;AAuBpCG,gBAvBoC;;AAwB1CrB,cAAEiB,EAAF,CAAKI,KAAKP,IAAV,EAAgBF,aAAhB,EAA+B,2DAA/B;;AAxB0C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA5C;;AAAA;AAAA;AAAA;AAAA","file":"read_test.js","sourcesContent":["import test from 'ava';\nimport { MongoDBServer } from 'mongomem';\n\nimport {\n  createMongoose\n} from '../test_helper';\n\ntest.before('start server', async t => {\n  await MongoDBServer.start();\n})\n\ntest.beforeEach('create mongoose connection', async (t) => {\n  const db = await createMongoose();\n  t.context.db = db;\n});\n\ntest('query user via `find` and `findOne`', async (t) => {\n  const { db } = t.context;\n  const User = db.models['user'];\n\n  console.log('db.collections');\n  console.log(db.collections);\n\n  console.log('db');\n  console.log(db);\n\n  await db.collections.users.drop();\n\n  const NEW_USER_NAME = 'Joe';\n  const joe = new User({ name: NEW_USER_NAME });\n  await joe.save();\n  const users = await User.find({ name: NEW_USER_NAME });\n\n  t.is(\n    users[0]._id.toString(),\n    joe._id.toString(),\n    'the id of the created object is same as the queried one'\n  );\n\n  const user = await User.findOne({ _id: joe._id });\n  t.is(user.name, NEW_USER_NAME, 'the name of the created object is same as the queried one');\n\n});\n\n"]}